<!DOCTYPE html>
<html>
<head>
    <title>âš¡ Ultra Fast BAL Converter</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial; padding: 20px; background: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; }
        textarea { width: 100%; height: 200px; padding: 10px; margin: 10px 0; }
        button { background: #4CAF50; color: white; padding: 10px 20px; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <h1>âš¡ Fast Converter</h1>
        <textarea id="code" placeholder="Paste JS code here...">console.log("Hello World");</textarea>
        <button onclick="ultraFastConvert()">Convert Now</button>
        <div id="result"></div>
    </div>

    <script>
        // ðŸš€ Ultra Fast Converter Class
        class FastBALConverter {
            constructor() {
                this.version = 2;
                this.magic = [0x42, 0x41, 0x4C, 0x32];
                this.currentKey = null;
            }
            
            // ðŸ”§ Simplified XOR encryption (Fastest)
            fastXorEncrypt(data, key = "FastKey!") {
                const encoder = new TextEncoder();
                const keyBytes = encoder.encode(key);
                const dataBytes = encoder.encode(data);
                const result = new Uint8Array(dataBytes.length);
                
                for (let i = 0; i < dataBytes.length; i++) {
                    result[i] = dataBytes[i] ^ keyBytes[i % keyBytes.length];
                }
                return result;
            }
            
            // âš¡ Fast conversion with minimal overhead
            convertFast(jsCode, filename = "fast.bal") {
                try {
                    // Generate simple key
                    const key = "KEY_" + Date.now() + "_" + Math.random().toString(36).substr(2, 8);
                    this.currentKey = key;
                    
                    // Encrypt quickly
                    const encrypted = this.fastXorEncrypt(jsCode, key);
                    
                    // Simple header (16 bytes only)
                    const header = new Uint8Array(16);
                    header.set(this.magic, 0);
                    header[4] = this.version;
                    
                    // Combine
                    const final = new Uint8Array(header.length + encrypted.length);
                    final.set(header, 0);
                    final.set(encrypted, header.length);
                    
                    return {
                        success: true,
                        data: final,
                        key: key,
                        filename: filename,
                        size: final.length
                    };
                } catch (e) {
                    return { success: false, error: e.message };
                }
            }
            
            // ðŸ“¥ Fast download
            downloadFast(data, filename) {
                const blob = new Blob([data], { type: 'application/octet-stream' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        }
        
        // ðŸŒ Global instance for quick access
        window.fastConverter = new FastBALConverter();
        
        // ðŸŽ¯ One-click conversion function
        async function ultraFastConvert() {
            const code = document.getElementById('code').value;
            if (!code.trim()) return alert('Enter code first!');
            
            const result = window.fastConverter.convertFast(code, 'output.bal');
            
            if (result.success) {
                // Show result immediately
                document.getElementById('result').innerHTML = `
                    <div style="margin-top:20px;padding:15px;background:#e8f5e9;border-radius:5px;">
                        <h3>âœ… Conversion Successful!</h3>
                        <p><strong>Key:</strong> ${result.key}</p>
                        <p><strong>File:</strong> ${result.filename}</p>
                        <p><strong>Size:</strong> ${result.size} bytes</p>
                        <button onclick="downloadNow()" style="background:#2196F3;">Download Now</button>
                    </div>
                `;
                
                // Store for download
                window.lastResult = result;
            } else {
                alert('Error: ' + result.error);
            }
        }
        
        function downloadNow() {
            if (window.lastResult) {
                window.fastConverter.downloadFast(
                    window.lastResult.data, 
                    window.lastResult.filename
                );
            }
        }
        
        // Auto-convert on paste (optional)
        document.getElementById('code').addEventListener('paste', function() {
            setTimeout(() => {
                if (this.value.length > 10) {
                    // Optional: auto-convert for small snippets
                    if (this.value.length < 1000) {
                        ultraFastConvert();
                    }
                }
            }, 100);
        });
    </script>
</body>
</html>
